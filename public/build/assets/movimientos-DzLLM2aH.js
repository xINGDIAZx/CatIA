import{_ as I,r as _,l as w,m as F,c as l,a as n,b as e,e as p,w as y,n as V,F as b,p as $,t as r,q as g,s as S,u as O,o as j,g as q,x,h as P,j as L,y as D}from"./app-CjCjMWra.js";import{_ as B,c as U}from"./catiaService-sekrHTdN.js";const z="/build/assets/up-ClofbNnq.png",G="/build/assets/down-r5xWs6eK.png",W={class:"mb-3"},A=["value"],T={class:"table border-amarillo table-striped parrafos rounded-4 mb-0 align-middle"},J={scope:"row"},K={key:0,src:z,alt:"up",width:"30"},Y={key:1,src:G,alt:"down",width:"30"},H={class:"fs-6"},Q={class:"fs-6"},R={class:"fs-6"},X={class:"fs-6"},Z={key:0,class:"mt-3"},ee={class:"pagination justify-content-center parrafos"},te=["onClick"],M=5,oe={__name:"table",props:{movements:{type:Array,required:!0}},setup(C){const c=C;console.log(c.movements);const i=new Date().toISOString().slice(0,7),v=_(i),s=w(()=>c.movements.filter(m=>new Date(m.mes).toISOString().slice(0,7)===v.value)),u=w(()=>[...new Set(c.movements.map(o=>o.mes))].sort().reverse()),a=_(1),k=w(()=>{const m=(a.value-1)*M,o=m+M;return s.value.slice(m,o)}),h=w(()=>Math.ceil(s.value.length/M)),f=m=>{a.value=m};return F(v,()=>{a.value=1}),(m,o)=>(n(),l(b,null,[e("div",W,[y(e("select",{"onUpdate:modelValue":o[0]||(o[0]=t=>v.value=t),class:"form-select border-amarillo parrafos rounded-4"},[(n(!0),l(b,null,$(u.value,t=>(n(),l("option",{key:t,value:t},r(new Date(Number(t.slice(0,4)),Number(t.slice(5,7))-1,1).toLocaleDateString("es-CO",{year:"numeric",month:"long"})),9,A))),128))],512),[[V,v.value]])]),e("table",T,[o[5]||(o[5]=e("thead",null,[e("tr",null,[e("th",{scope:"col"}),e("th",{scope:"col"},"Detalle Ingreso"),e("th",{scope:"col"},"Ingreso"),e("th",{scope:"col"},"Detalle Gasto"),e("th",{scope:"col"},"Gasto")])],-1)),e("tbody",null,[(n(!0),l(b,null,$(k.value,t=>(n(),l("tr",{key:t.id},[e("th",J,[t.ingreso?(n(),l("img",K)):p("",!0),t.gasto?(n(),l("img",Y)):p("",!0)]),e("td",H,[g(r(t.detalle_ingreso)+" ",1),o[3]||(o[3]=e("br",null,null,-1)),g(" "+r(t.detalle_ingreso?new Date(t.created_at).toLocaleDateString("es-CO",{day:"2-digit",month:"2-digit",year:"numeric"}):""),1)]),e("td",Q,r(t.ingreso?Number(t.ingreso).toLocaleString("es-CO",{style:"currency",currency:"COP",maximumFractionDigits:0})+" COP":""),1),e("td",R,[g(r(t.detalle_gasto)+" ",1),o[4]||(o[4]=e("br",null,null,-1)),g(" "+r(t.detalle_gasto?new Date(t.created_at).toLocaleDateString("es-CO",{day:"2-digit",month:"2-digit",year:"numeric"}):""),1)]),e("td",X,r(t.gasto?Number(t.gasto).toLocaleString("es-CO",{style:"currency",currency:"COP",maximumFractionDigits:0})+" COP":""),1)]))),128))])]),h.value>1?(n(),l("nav",Z,[e("ul",ee,[e("li",{class:S(["page-item",{disabled:a.value===1}])},[e("a",{class:"btn text-white border-amarillo parrafos rounded-4",href:"#",onClick:o[1]||(o[1]=O(t=>f(a.value-1),["prevent"]))},o[6]||(o[6]=[e("i",{class:"las la-angle-double-left"},null,-1)]))],2),(n(!0),l(b,null,$(h.value,t=>(n(),l("li",{key:t,class:S(["page-item mx-1",{active:a.value===t}])},[e("a",{class:"btn text-white border-amarillo parrafos rounded-4",href:"#",onClick:O(d=>f(t),["prevent"])},r(t),9,te)],2))),128)),e("li",{class:S(["page-item",{disabled:a.value===h.value}])},[e("a",{class:"btn text-white border-amarillo parrafos rounded-4",href:"#",onClick:o[2]||(o[2]=O(t=>f(a.value+1),["prevent"]))},o[7]||(o[7]=[e("i",{class:"las la-angle-double-right"},null,-1)]))],2)])])):p("",!0)],64))}},se=I(oe,[["__scopeId","data-v-4ee4f9a9"]]),ae={key:0,class:"container-fluid",id:"id-opinion"},le={class:"container"},ne={class:"row d-flex justify-content-center"},ie={class:"col-md-6 col-12 d-flex justify-content-center align-items-end position-relative"},re={class:"w-75"},de={class:"speech-bubble m-2"},ue={class:"speech-bubble-text pe-3"},ce={class:"parrafos fs-6"},me={__name:"opinion",setup(C){const c=_("");j(()=>{window.addEventListener("opinion",s=>{c.value=s.detail.opinion,i()})});const i=()=>{q.timeline().to("#id-opinion",{opacity:0,y:200,duration:1.5}).from("#id-opinion",{opacity:0,y:200,duration:1.5})},v=()=>{q.to("#id-opinion",{opacity:0,y:200,duration:1.5,onComplete:()=>{c.value=""}})};return(s,u)=>c.value?(n(),l("div",ae,[e("div",le,[e("div",ne,[e("div",ie,[u[1]||(u[1]=e("div",{class:"w-25"},[e("img",{src:B,alt:"CatIA",class:"img-data"})],-1)),e("div",re,[e("div",de,[e("div",ue,[e("p",ce,r(c.value),1)])])]),e("div",{class:"position-absolute top-0 end-0 btn btn-cerrar rounded-circle",onClick:v},u[0]||(u[0]=[e("i",{class:"las la-times-circle display-6"},null,-1)]))])])])])):p("",!0)}},pe=I(me,[["__scopeId","data-v-c7f90642"]]),ve={class:"container mt-4"},_e={key:0,class:"row"},ge={class:"col-12 d-flex justify-content-center"},fe=["onClick"],be={class:"card-body d-flex flex-column align-items-center"},he={class:"parrafo"},ye={key:1,class:"row"},we={class:"col-12 position-relative border-2 border-amarillo rounded-4 p-3"},xe={class:"titulos fs-3 text-center"},$e={class:"parrafos text-center"},Ce={class:"w-100 d-flex justify-content-center mt-2"},ke={class:"parrafos bg-warning rounded-pill text-dark fs-4 p-2 px-4"},Se={key:2,class:"row mt-3"},Oe={class:"col-12 col-sm-12 col-md-4 p-0 mb-3"},De={class:"border-2 border-amarillo rounded-4 p-3"},Me={class:"form-label parrafos"},Ie={key:0,class:"text-danger"},Ne={class:"input-group w-100 mb-3"},qe={class:"form-label parrafos"},Pe={key:0,class:"text-danger"},Ve={class:"input-group w-100 mb-3"},je={class:"form-label parrafos"},Ee={key:0,class:"text-danger"},Fe={class:"input-group w-100 mb-3"},Le={class:"form-label parrafos"},Be={key:0,class:"text-danger"},Ue={class:"input-group w-100 mb-3"},ze={class:"col-12 col-sm-12 col-md-8 p-0 ps-3"},Ge={class:"border-2 border-amarillo rounded-4 p-3 table-responsive"},We={__name:"movimientos",setup(C){const c=_([]),i=_(null),v=_([]),s=_({tipo:"",monto:"",fecha:"",detalle:"",monto_total:""});let u={datos_del_usuario:{nombre_usuario:JSON.parse(localStorage.getItem("user")).name,billetera_antes_de_movimientos:null,ingresos:[],gastos:[],billetera_despues_de_movimientos:null}};const a=_({tipo:"",monto:"",fecha:"",detalle:""}),k=()=>{let o=!0;return a.value={tipo:"",monto:"",fecha:"",detalle:""},s.value.tipo||(a.value.tipo="El tipo es obligatorio",o=!1),s.value.monto||(a.value.monto="El monto es obligatorio",o=!1),s.value.fecha||(a.value.fecha="La fecha es obligatoria",o=!1),s.value.detalle||(a.value.detalle="El detalle es obligatorio",o=!1),o},h=async o=>{if(o.preventDefault(),!!k())try{const t=new Date(s.value.fecha),d=`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}`;await x.addMovementsbyWallet({wallet_id:i.value.id,tipo:s.value.tipo,monto:s.value.monto,mes:d,detalle:s.value.detalle,monto_total:c.value.monto}),u.datos_del_usuario.billetera_antes_de_movimientos=i.value.monto,s.value.tipo==="Ingreso"?(u.datos_del_usuario.ingresos.push({ingreso:s.value.monto,detalle_ingreso:s.value.detalle}),u.datos_del_usuario.billetera_despues_de_movimientos=i.value.monto+s.value.monto):(u.datos_del_usuario.gastos.push({gasto:s.value.monto,detalle_gasto:s.value.detalle}),u.datos_del_usuario.billetera_despues_de_movimientos=i.value.monto-s.value.monto),s.value={tipo:"",monto:"",fecha:"",detalle:""},v.value=await x.getMovementsbyWallet({wallet_id:i.value.id}),await m();const N=await U.opinionCatia(u);window.dispatchEvent(new CustomEvent("opinion",{detail:{opinion:N.response}})),u={datos_del_usuario:{nombre_usuario:JSON.parse(localStorage.getItem("user")).name,billetera_antes_de_movimientos:null,ingresos:[],gastos:[],billetera_despues_de_movimientos:null}},i.value=c.value.find(E=>E.id===i.value.id)}catch(t){console.error("Error al agregar movimiento:",t)}},f=async o=>{i.value=o,v.value=await x.getMovementsbyWallet({wallet_id:i.value.id})};j(async()=>{await m()});const m=async()=>{const o=await x.refreshUser({user_id:JSON.parse(localStorage.getItem("user")).id});c.value=o.user.billeteras};return(o,t)=>(n(),l(b,null,[e("div",ve,[i.value?p("",!0):(n(),l("div",_e,[e("div",ge,[(n(!0),l(b,null,$(c.value,d=>(n(),l("div",{class:"card rounded-4 me-2",key:d.id,onClick:N=>f(d)},[e("div",be,[t[5]||(t[5]=e("img",{src:L,alt:"Billetera",width:"50"},null,-1)),e("p",he,r(d.nombre),1)])],8,fe))),128))])])),i.value?(n(),l("div",ye,[e("div",we,[e("h5",xe,r(i.value.nombre),1),e("p",$e,r(i.value.descripcion),1),e("div",Ce,[e("span",ke,r(Number(i.value.monto).toLocaleString("es-CO",{style:"currency",currency:"COP",maximumFractionDigits:0}))+" COP ",1)]),e("button",{class:"btn btn-danger rounded-4 position-absolute top-0 end-0 m-1",onClick:t[0]||(t[0]=d=>f(null))},t[6]||(t[6]=[e("i",{class:"las la-times"},null,-1)]))])])):p("",!0),i.value?(n(),l("div",Se,[e("div",Oe,[e("form",De,[t[12]||(t[12]=e("h2",{class:"text-center titulos fs-4 mb-4"}," Agregar Movimiento ",-1)),e("label",Me,[t[7]||(t[7]=g(" Tipo ")),a.value.tipo?(n(),l("small",Ie,r(a.value.tipo),1)):p("",!0)]),e("div",Ne,[y(e("select",{class:"input-group-text parrafos w-100 rounded-4 izq",id:"tipo",placeholder:"ej: Ingreso","onUpdate:modelValue":t[1]||(t[1]=d=>s.value.tipo=d),required:""},t[8]||(t[8]=[e("option",{value:"Ingreso"},"Ingreso",-1),e("option",{value:"Gasto"},"Gasto",-1)]),512),[[V,s.value.tipo]])]),e("label",qe,[t[9]||(t[9]=g(" Monto ")),a.value.monto?(n(),l("small",Pe,r(a.value.monto),1)):p("",!0)]),e("div",Ve,[y(e("input",{type:"number",class:"input-group-text parrafos w-100 rounded-4 izq",id:"monto",placeholder:"ej: 12000","onUpdate:modelValue":t[2]||(t[2]=d=>s.value.monto=d),required:""},null,512),[[D,s.value.monto]])]),e("label",je,[t[10]||(t[10]=g(" Fecha ")),a.value.fecha?(n(),l("small",Ee,r(a.value.fecha),1)):p("",!0)]),e("div",Fe,[y(e("input",{type:"date",class:"input-group-text parrafos w-100 rounded-4 izq",id:"mes","onUpdate:modelValue":t[3]||(t[3]=d=>s.value.fecha=d),required:""},null,512),[[D,s.value.fecha]])]),e("label",Le,[t[11]||(t[11]=g(" Detalle ")),a.value.detalle?(n(),l("small",Be,r(a.value.detalle),1)):p("",!0)]),e("div",Ue,[y(e("input",{type:"text",class:"input-group-text parrafos w-100 rounded-4 izq",id:"detalle",placeholder:"ej: Comida","onUpdate:modelValue":t[4]||(t[4]=d=>s.value.detalle=d),required:""},null,512),[[D,s.value.detalle]])]),e("button",{type:"submit",class:"btn btn-save rounded-4 w-100 mt-3 parrafos",onClick:h}," Guardar ")])]),e("div",ze,[e("div",Ge,[P(se,{movements:v.value},null,8,["movements"])])])])):p("",!0)]),P(pe,{class:"opinion"})],64))}},Je=I(We,[["__scopeId","data-v-fcf443e1"]]);export{Je as default};
